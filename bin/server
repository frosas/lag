#!/bin/bash

set -ex

source $(dirname $0)/common

on_sigint() { kill 0; }
trap on_sigint SIGINT
    
if [[ $is_dev ]]; then
    webpack --watch &
    nodemon --exec 'eslint .' &
fi

forever \
    --minUptime 1000 \
    --spinSleepTime 1000 \
    $([[ $is_dev ]] && echo '-w') \
    src/server/http.js &

wait